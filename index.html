
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>API Documentation</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .cd {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .nl {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <link href="stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" media="print" />
      <script src="javascripts/all_nosearch.js"></script>
  </head>

  <body class="index" data-languages="[]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" alt="Navbar" />
      </span>
    </a>
    <div class="toc-wrapper">
      <img src="images/logo.png" class="logo" alt="Logo" />
      <ul id="toc" class="toc-list-h1">
          <li>
            <a href="#class-server" class="toc-h1 toc-link" data-title="class Server">class <em>Server</em></a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#introduction" class="toc-h2 toc-link" data-title="Introduction">Introduction</a>
                  </li>
                  <li>
                    <a href="#examples" class="toc-h2 toc-link" data-title="Examples">Examples</a>
                  </li>
              </ul>
          </li>
      </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id='class-server'>class <em>Server</em></h1><h2 id='introduction'>Introduction</h2>
<p>This class implements all data communication methods with server. We use <a href="https://firebase.google.cn/">Firebase</a>
as our backend provider. We provide full backend supports, and can make minor adjustment according to your frontend
development needs. You should handle all UI events, sending request to server,
and respond to listened events, etc. For example:</p>

<ul>
<li>Show a message to user if he typed any invalid character in password input field.</li>
<li>Create UI buttons, add listeners to them and send corresponding request to server, then handle the servers respond.</li>
<li>Listen on messages from the server, and show them to the user once the event is triggered.</li>
</ul>
<h2 id='examples'>Examples</h2>
<p>Here are some examples on using class <em>Server</em> to communicate with the server.</p>
<h3 id='scenario-1-sign-in'>Scenario #1 - Sign In</h3>
<blockquote>
<p>Sample code (Unity C#)</p>
</blockquote>
<pre class="highlight csharp tab-csharp"><code>  <span class="k">public</span> <span class="n">Text</span> <span class="n">message</span><span class="p">;</span>
  <span class="k">public</span> <span class="n">InputField</span> <span class="n">usernameInput</span><span class="p">;</span>
  <span class="k">public</span> <span class="n">InputField</span> <span class="n">passwordInput</span><span class="p">;</span>

  <span class="k">void</span> <span class="nf">SignInEventHandler</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// handles error</span>
      <span class="n">message</span><span class="p">.</span><span class="n">text</span> <span class="p">=</span> <span class="s">"服务器错误"</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">res</span><span class="p">.</span><span class="n">approved</span> <span class="p">==</span> <span class="k">true</span><span class="p">)</span>
        <span class="n">SceneManager</span><span class="p">.</span><span class="nf">LoadScene</span><span class="p">(</span><span class="s">"Welcome"</span><span class="p">);</span>
      <span class="k">else</span> <span class="n">message</span><span class="p">.</span><span class="n">text</span> <span class="p">=</span> <span class="s">"用户名或密码错误"</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="k">void</span> <span class="nf">SignInButtonClicked</span><span class="p">()</span> <span class="p">{</span>
    <span class="kt">string</span> <span class="n">username</span> <span class="p">=</span> <span class="n">usernameInput</span><span class="p">.</span><span class="n">text</span><span class="p">;</span>
    <span class="kt">string</span> <span class="n">password</span> <span class="p">=</span> <span class="n">passwordInput</span><span class="p">.</span><span class="n">text</span><span class="p">;</span>
    <span class="c1">// TODO: validate user input</span>

    <span class="c1">// send sign-in request to server</span>
    <span class="n">Server</span><span class="p">.</span><span class="nf">SignIn</span><span class="p">(</span><span class="n">SignInEventHandler</span><span class="p">,</span> <span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="p">);</span>
  <span class="p">}</span>
</code></pre>
<p>Use method <code>Server.SignIn</code> to send a asynchronous sign-in request to server.</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>handler</td>
<td>void</td>
<td>A function for handling the asynchronous response.</td>
</tr>
<tr>
<td>username</td>
<td>string</td>
<td>The username of the user.<br>Should be a valid phone number with country code.<br>For example, if a Chinese user&#39;s phone number is 138xxxxxxxx then the string value should be <code>+86138xxxxxxxx</code>.</td>
</tr>
<tr>
<td>password</td>
<td>string</td>
<td>The password of the user.<br>Should satisfy the following rules:<br><ul><li>a minimum of 6 characters required</li><li>no more than 15 characters</li><li>a-z, A-Z, 0-9 allowed</li><li>special characters allowed <code>~`!@#$%^&amp;*()-_+=&#124;}]{[&quot;&#39;:;?/&gt;.&lt;,</code></li><li>white space allowed</li></ul></td>
</tr>
</tbody></table>
<h4 id='respond-parameters-passed-to-the-handler'>Respond (parameters passed to the handler):</h4>
<ul>
<li><code>bool approved</code>: if the sign-in request has been approved</li>
<li><code>string uid</code>: a unique ID for this user</li>
</ul>
<h4 id='returns'>Returns</h4>
<ul>
<li>void</li>
</ul>
<h3 id='scenario-2-game-state-listening'>Scenario #2 - Game State Listening</h3>
<blockquote>
<p>Sample code (Unity C#)</p>
</blockquote>
<pre class="highlight csharp tab-csharp"><code>  <span class="k">public</span> <span class="kt">string</span> <span class="n">uid</span> <span class="p">=</span> <span class="s">"QYcNR3JP2Jge0vrah9LFbX9KrmQ2"</span><span class="p">;</span>
  <span class="k">public</span> <span class="n">Text</span> <span class="n">message</span><span class="p">;</span>
  <span class="k">public</span> <span class="n">Text</span> <span class="n">pot_size</span><span class="p">;</span>

  <span class="k">void</span> <span class="nf">GameStateHandler</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// handles error</span>
      <span class="n">message</span><span class="p">.</span><span class="n">text</span> <span class="p">=</span> <span class="s">"服务器错误"</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="n">pot_size</span><span class="p">.</span><span class="n">text</span> <span class="p">=</span> <span class="p">(</span><span class="kt">string</span><span class="p">)</span><span class="n">res</span><span class="p">.</span><span class="n">pot_size</span><span class="p">;</span>
      <span class="c1">// TODO: more UI responses</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="k">void</span> <span class="nf">Start</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// start listening on server game state</span>
    <span class="n">Server</span><span class="p">.</span><span class="nf">ListenGameState</span><span class="p">(</span><span class="n">GameStateHandler</span><span class="p">,</span> <span class="n">uid</span><span class="p">);</span>
  <span class="p">}</span>
</code></pre>
<p>When user is in game, the client should listen to database events, and the UI should
respond to these events accordingly. Use <code>Server.ListenGameState</code> to listen.</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>handler</td>
<td>void</td>
<td>The handler of game events.<br>Triggered every time the server game state changed.</td>
</tr>
<tr>
<td>uid</td>
<td>string</td>
<td>The uid obtained on user sign-in.</td>
</tr>
</tbody></table>
<h4 id='respond-parameters-passed-to-the-handler-2'>Respond (parameters passed to the handler):</h4>
<ul>
<li><code>uint pot_size</code>: the size of the pot</li>
<li>other information such as flop card value and current player id</li>
</ul>
<h4 id='returns-2'>Returns:</h4>
<ul>
<li><code>bool status</code>: if the listener has been successfully started</li>
</ul>

      </div>
      <div class="dark-box">
      </div>
    </div>
  </body>
</html>
